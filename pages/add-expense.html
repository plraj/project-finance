<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Expense</title>
    <link rel="stylesheet" href="..\css\inc_exp.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <div id="navbar-container">
    </div>
    

    <div class="container">
        <div class="add_inc_exp_cont mt-5">
            <div class="inc_exp_head">
                <div class="inc_exp_head_txt text-center m">
                    <h2>Add Income and Expense</h2>
                </div>
                <div class="inc_exp_dt">

                    <div class="tdy_date">
                        <h2 id= "tdy_date"> 18 June 2025</h2>
                    </div>
                    <div class="tlt_blane">
                        <div>Balance</div>
                        <div id ="tbalance">
                            ₹  <span id="totalbalance"> 200</span>
                        </div>
                    </div>
                </div>
            </div>

            <div >
                <div class="cont_in_exp d-flex gap-3">
                    <div class="col-lg-6 col-md-12">
                        <div class="income_container">
                            <div class="inc_cont_head">
                                <h2>Income </h2>
                                <button data-bs-toggle="modal" data-bs-target="#incomemodeal">Add Income</button>
                            </div>
                            <div id="inc_cont_txt">
                                <div class="inc_cont_txt" >
                                    <div class="inc_txt_detls">
                                        <div class="inc_on_date">
                                            <p>16 march 2025</p>
                                        </div>
                                        <div class="inc_dtls_txt_writen">
                                            <h3>Land sell</h3>
                                            <span > ₹ <span id ="incPrice" class="incPrice">2000</span> </span>
                                        </div>
                                    </div>
    
                                </div>

                                <div class="inc_cont_txt" >
                                    <div class="inc_txt_detls">
                                        <div class="inc_on_date">
                                            <p>${date}</p>
                                        </div>
                                        <div class="inc_dtls_txt_writen">
                                            
                                            <h3>${details}</h3>
                                            
                                            <span > ₹ <span id ="incPrice" class="incPrice">100</span> </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="col-lg-6 col-md-12">
                        <div class="expense_container">
                            <div class="exp_cont_head">
                                <h2>Expense </h2>
                                <button data-bs-toggle="modal" data-bs-target = "#expansemodel">Add Expense</button>
                            </div>
                            <div class="exp_cont_txt " id = "exp_cont_txt">
                                <div class="exp_txt_detls">
                                    <div class="exp_on_date">
                                        <p>16 march 2025</p>
                                    </div>
                                    <div class="exp_dtls_txt_writen">
                                        
                                        <h3>Land buy</h3>
                                        <span> ₹  <span id ="expPrice" class="expPrice">20500</span> </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for income-->
    <div class="modal fade" id="incomemodeal" tabindex="-1" aria-labelledby="incomemodellabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <h1 class="modal-title fs-5" id="incomemodellabel">Add Income</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="exampleFormControlTextarea1" class="form-label">Income Details</label>
                    <textarea class="form-control" id="income_dtls" rows="1"></textarea>
                </div>
                <div class="mb-3">
                    <label for="priceInput" class="form-label">Price</label>
                    <textarea class="form-control" id="income_price" rows="1" oninput="this.value = this.value.replace(/[^0-9]/g, '');"></textarea>
                </div>
                <div class="mb-3">
                    <label for="income_date" class="income_date">Date</label>
                    <input type="date" class="form-control" id="income_date"> 
                </div>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" onclick="addIncomeDetails()">Save changes</button>
            </div>
        </div>
        </div>
    </div>

    <!-- Modal for expens -->
    <div class="modal fade" id="expansemodel" tabindex="-1" aria-labelledby="expansemodelLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <h1 class="modal-title fs-5" id="expansemodelLabel">Add Expense </h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="expense_dtls" class="form-label">Expense Details</label>
                    <textarea class="form-control" id="expense_dtls" rows="1"></textarea>
                </div>
                <div class="mb-3">
                    <label for="expense_price" class="form-label">Price</label>
                    <textarea class="form-control" id="expense_price" rows="1" oninput="this.value = this.value.replace(/[^0-9]/g, '');"></textarea>
                </div>
                <div class="mb-3">
                    <label for="expense_date" class="form-label">Date</label>
                    <input type="date" class="form-control" id ="expense_date">
                </div>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" onclick="addExpenseDetails()">Save changes</button>
            </div>
        </div>
        </div>
    </div>

    <div id="footercontainer">

    </div>

    <script>
        navbar_cont = document.getElementById("navbar-container")
        footer_container = document.getElementById("footercontainer")

        fetch('../component/nav.html').then(
            response => response.text()
        ).then(data =>{
            navbar_cont.innerHTML = data;
        })

        fetch('../component/footer.html').then(
            response => response.text()
        ).then(data =>{
            footer_container.innerHTML = data
        })

        // to get today date 
        getdate = document.getElementById("tdy_date");

        function getTodayDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = today.toLocaleString('en-US', { month: 'long' });
            const day = String(today.getDate()).padStart(2, '0');
            getdate.innerText = `${day} ${month} ${year}`;
        }
        window.onload = getTodayDate;

    </script>

    <!-- to add income and expense data  -->
    <!-- <script>
        income_dtls = document.getElementById("income_dtls");
        income_price = document.getElementById("income_price");
        income_date = document.getElementById("income_date");
        inc_cont_txt_to_write = document.getElementById("exp_cont_txt");

        function addIncomeDetails(){


            console.log("ff");

            inc_cont_txt_to_write.innerHTML += 
            `
                <div class="exp_txt_detls">
                    <div class="exp_on_date">
                        <p>${details}</p>
                    </div>
                    <div class="exp_dtls_txt_writen">
                        
                        <h3>${income_dtls.innerText}</h3>
                        <span> ₹ ${income_price.innerText}</span>
                    </div>
                </div>
            `;
        }


    </script> -->

    <script>
        totalbalances = document.getElementById("totalbalance");
        const tbalance = document.getElementById("tbalance");

        income_dtls = document.getElementById("income_dtls");
        income_price = document.getElementById("income_price");
        income_date = document.getElementById("income_date");
        inc_cont_txt_to_write = document.getElementById("inc_cont_txt");

        expense_dtls = document.getElementById("expense_dtls");
        expense_price = document.getElementById("expense_price");
        expense_date = document.getElementById("expense_date");
        exp_cont_txt_to_write = document.getElementById("exp_cont_txt");

    
        function formatdate(datastring){
            const date = new Date(datastring);
            const day = date.getDate();
            const monthNames = [
                "Jan" , "Feb", "Mar", "Apl", "May",
                "Jun", "July" , "Aug" , "Sep", "Oct", "Nov", "Dec"
            ];
            const month = monthNames[date.getMonth()];
            const year = date.getFullYear();
            return `${day} ${month} ${year}`;
        }

        function totalbalance (){

            const incPrice = document.querySelectorAll(".incPrice");
            const expPrice = document.querySelectorAll(".expPrice");

            balance = 0;

            incPrice.forEach(element => {
                console.log(element);
                const value = parseFloat(element.innerText); // Get and parse value
                if (!isNaN(value)) { // Check if it's a valid number
                    balance += value;
                    
                    console.log("Element value:", value, "Current balance:", balance);
                } else {
                    console.error("Invalid income price:", element.innerText);
                }
            });
            expPrice.forEach(element => {
                const value = parseFloat(element.innerText); // Get and parse value
                if (!isNaN(value)) { // Check if it's a valid number
                    balance -= value;
                    
                    console.log("Element value:", value, "Current balance:", balance);
                } else {
                    console.error("Invalid income price:", element.innerText);
                }
            });

            totalbalances.innerText = balance;

            if(balance > 0){
                tbalance.style.color ="green";
            }
            else if(balance < 0){
                tbalance.style.color ="red";
            }
            else{
                tbalance.style.color = "black";
            }


        }

        function addIncomeDetails() {
            const details = income_dtls.value;
            const price = income_price.value;
            const rawdate = income_date.value; 
            const date = formatdate(rawdate);

            if ( !price || !date) {
                alert("Please fill in all fields.");
                return;
            }
            inc_cont_txt_to_write.innerHTML += `
                <div class="inc_cont_txt" >
                    <div class="inc_txt_detls">
                        <div class="inc_on_date">
                            <p>${date}</p>
                        </div>
                        <div class="inc_dtls_txt_writen">
                            
                            <h3>${details}</h3>
                            
                            <span > ₹ <span id ="incPrice" class="incPrice">${price}</span> </span>
                        </div>
                    </div>
                </div>
            `;
    
            // Clear the input fields
            income_dtls.value = "";
            income_price.value = "";
            income_date.value = "";
            totalbalance();
        }

        function addExpenseDetails(){
            const details = expense_dtls.value;
            const price = expense_price.value;
            const rawdate = expense_date.value; 
            const date = formatdate(rawdate);

            if ( !price || !date) {
                alert("Please fill in all fields.");
                return;
            }

            exp_cont_txt_to_write.innerHTML += 
                `
                    <div class="exp_txt_detls">
                        <div class="exp_on_date">
                            <p>${date}</p>
                        </div>
                        <div class="exp_dtls_txt_writen">
                            <h3>${details}</h3>
                            <span> ₹ <span id ="expPrice" class="expPrice">${price}</span> </span>
                        </div>
                    </div>
                `
            expense_dtls.value = "";
            expense_price.value = "";
            expense_date.value = "";
            totalbalance();

        }

        window.onload = totalbalance;
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    
</body>
</html>